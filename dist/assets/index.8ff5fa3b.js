import{r as e,H as t,V as n,u as r,b as a,I as o,S as s,M as l,a as c,C as i,E as u,Q as m,d as g,R as d,O as f,c as p,G as E,e as h,A as b,f as w,g as x}from"./vendor.6c96f80b.js";const v=()=>e.exports.createElement(t,{center:!0},e.exports.createElement("div",{className:"loading"},"Loading..."));var y=!!window.location.search.split("debug=")[1];const S=async(e="https://images.unsplash.com/photo-1623408861528-27ff44f27da5?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=934&q=80")=>{const t=new Image;t.src=e,t.setAttribute("crossOrigin",""),await new Promise((e=>{t.onload=()=>e()}));const{naturalHeight:r,naturalWidth:a}=t,o=document.createElement("canvas");o.width=r,o.height=a;const s=o.getContext("2d");s.drawImage(t,0,0),y&&(e=>{document.querySelector("#root").appendChild(e)})(o);const l=[];for(let c=0;c<a;c++)for(let e=0;e<r;e++)if(e%50==0){const{data:t}=s.getImageData(e,c,1,1),r={r:t[0],g:t[1],b:t[2],a:t[3]};l.push(new n(r.r,r.g,r.b))}return(e=>{const t=e.reduce(((e,t)=>{const n=JSON.stringify(t);return t.x<10&&t.y<10&&t.z<10?e[n]={vector:t,count:1}:e[n]?e[n].count++:e[n]={vector:t,count:1},e}),{});return Object.values(t)})(l)},M=({imageSrc:t})=>{const{scene:g}=r(),d=a(S,[t]),f=e.exports.useMemo((()=>new o(new s(1,32,32),new l({shininess:100}),d.length)),[d]);return e.exports.useEffect((()=>{d.forEach(((e,t)=>{const r=new c,a=new u,o=new m,s=Math.min(25,e.count),l=new n(s,s,s);o.setFromEuler(a),r.compose(e.vector,o,l),f.setMatrixAt(t,r);const g=e.vector.normalize(),d=new i(g.x,g.y,g.z);f.setColorAt(t,d)})),null==g||g.add(f)}),[d]),null};const k=({setImage:t})=>{const n=e.exports.useRef();return e.exports.useEffect((()=>{g.registerDialog(n.current)}),[]),d.createElement("dialog",{ref:n,open:!0},d.createElement("form",{onSubmit:e=>{e.preventDefault();const n=new FormData(e.currentTarget).get("image-src");t(n),e.currentTarget.reset()}},d.createElement("label",null,d.createElement("div",null,"Paste an image URL to start"),d.createElement("input",{name:"image-src",type:"url",inputMode:"url",autoFocus:!0})),d.createElement("a",{className:"link",href:"https://unsplash.com",target:"_blank",rel:"noreferrer"},"Try Unsplash",d.createElement("br",null),"The internetâ€™s source of freely-usable images."),d.createElement("button",{type:"submit"},"Submit")))};const C=!!window.location.search.split("ar=")[1]?b:w;function D(){const[t,n]=e.exports.useState(null),r=e.exports.useRef();return d.createElement(d.Fragment,null,d.createElement(C,{style:{height:"75vh",width:"100vw",border:"1px solid black"},key:t},d.createElement(f,{makeDefault:!0,autoRotate:!0,position:[-10,-10,-5],rotation:[3,-1,2.5533897942197092],zoom:3},d.createElement("ambientLight",null),d.createElement("pointLight",{position:[10,10,10]}),t&&d.createElement(e.exports.Suspense,{fallback:d.createElement(v,null)},d.createElement(M,{imageSrc:t})),d.createElement(p,{ref:r}),y&&d.createElement(E,{alignment:"bottom-right",margin:[80,80],onTarget:()=>{var e;return null==(e=null==r?void 0:r.current)?void 0:e.target},onUpdate:()=>{var e;return null==(e=r.current)?void 0:e.update()}},d.createElement(h,{axisColors:["red","green","blue"],labelColor:"white"})))),t?d.createElement("div",{className:"flex-center"},d.createElement("button",{onClick:()=>n(null)},"New image"),d.createElement("img",{className:"thumbnail",src:t,alt:"thumbnail"})):d.createElement(k,{setImage:n}))}x.render(d.createElement(d.StrictMode,null,d.createElement(D,null)),document.getElementById("root"));
