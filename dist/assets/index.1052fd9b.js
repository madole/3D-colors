import{r as e,H as t,V as n,u as a,b as r,I as s,S as o,M as l,a as c,C as m,E as i,Q as u,d as g,R as E,c as d,O as f,e as p,f as w}from"./vendor.81843995.js";const h=()=>e.exports.createElement(t,{center:!0},e.exports.createElement("div",{className:"loading"},"Loading...")),b=async(e="https://images.unsplash.com/photo-1623408861528-27ff44f27da5?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=934&q=80")=>{const t=new Image;t.src=e,t.setAttribute("crossOrigin",""),await new Promise((e=>{t.onload=()=>e()}));const{naturalHeight:a,naturalWidth:r}=t,s=document.createElement("canvas");s.width=a,s.height=r;const o=s.getContext("2d");o.drawImage(t,0,0);const l=[];for(let c=0;c<r;c++)for(let e=0;e<a;e++)if(e%500==0||c%500==0){const{data:t}=o.getImageData(e,c,1,1),a={r:t[0],g:t[1],b:t[2],a:t[3]};l.push(new n(a.r,a.g,a.b))}return(e=>{const t=e.reduce(((e,t)=>{const n=JSON.stringify(t);return t.x<10&&t.y<10&&t.z<10?e[n]={vector:t,count:1}:e[n]?e[n].count++:e[n]={vector:t,count:1},e}),{});return Object.values(t)})(l)},x=({imageSrc:t})=>{const{scene:g}=a(),E=r(b,[t]),d=e.exports.useMemo((()=>new s(new o(1,32,32),new l({shininess:100}),E.length)),[E]);return e.exports.useEffect((()=>{E.forEach(((e,t)=>{const a=new c,r=new i,s=new u,o=Math.min(25,e.count),l=new n(o,o,o);s.setFromEuler(r),a.compose(e.vector,s,l),d.setMatrixAt(t,a);const g=e.vector.normalize(),E=new m(g.x,g.y,g.z);d.setColorAt(t,E)})),null==g||g.add(d)}),[E]),null},v=({setImage:t})=>{const n=e.exports.useRef();return e.exports.useEffect((()=>{g.registerDialog(n.current)}),[]),E.createElement("dialog",{ref:n,open:!0},E.createElement("form",{onSubmit:e=>{e.preventDefault();const n=new FormData(e.currentTarget).get("image-src");t(n),e.currentTarget.reset()}},E.createElement("label",null,E.createElement("div",null,"Paste an image URL to start"),E.createElement("input",{name:"image-src",type:"url",inputMode:"url",autoFocus:!0})),E.createElement("button",{type:"submit"},"Submit")))};function y(){const[t,n]=e.exports.useState(null);return E.createElement(E.Fragment,null,E.createElement(d,{style:{height:"85vh",width:"100vw",border:"1px solid black"},key:t},E.createElement(f,{makeDefault:!0,autoRotate:!0,position:[-10,-10,-5],rotation:[3,-1,2.5533897942197092],zoom:3},E.createElement("ambientLight",null),E.createElement("pointLight",{position:[10,10,10]}),t&&E.createElement(e.exports.Suspense,{fallback:E.createElement(h,null)},E.createElement(x,{imageSrc:t})),E.createElement(p,null))),t?E.createElement("div",{className:"flex-center"},E.createElement("button",{onClick:()=>n(null)},"New image"),E.createElement("img",{className:"thumbnail",src:t,alt:"thumbnail"})):E.createElement(v,{setImage:n}))}w.render(E.createElement(E.StrictMode,null,E.createElement(y,null)),document.getElementById("root"));
