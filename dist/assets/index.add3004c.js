import{r as e,H as t,V as n,u as a,b as r,I as l,S as s,M as o,a as c,C as i,E as u,Q as m,R as d,d as g,O as p,c as E,G as f,e as h,A as b,f as w,g as v}from"./vendor.6c96f80b.js";const x=()=>e.exports.createElement(t,{center:!0},e.exports.createElement("div",{className:"loading"},"Loading..."));var y=!!window.location.search.split("debug=")[1];const S=async e=>{const t=new Image;if(e instanceof File){const n=new FileReader;n.onloadend=e=>{t.src=n.result},n.readAsDataURL(e)}else t.src=e;t.setAttribute("crossOrigin",""),await new Promise((e=>{t.onload=()=>e()}));const{naturalHeight:a,naturalWidth:r}=t,l=document.createElement("canvas");l.width=a,l.height=r;const s=l.getContext("2d");s.drawImage(t,0,0),y&&(e=>{document.querySelector("#root").appendChild(e)})(l);const o=[];for(let c=0;c<r;c++)for(let e=0;e<a;e++)if(e%50==0){const{data:t}=s.getImageData(e,c,1,1),a={r:t[0],g:t[1],b:t[2],a:t[3]};o.push(new n(a.r,a.g,a.b))}return(e=>{const t=e.reduce(((e,t)=>{const n=JSON.stringify(t);return t.x<10&&t.y<10&&t.z<10?e[n]={vector:t,count:1}:e[n]?e[n].count++:e[n]={vector:t,count:1},e}),{});return Object.values(t)})(o)},F=({imageSrc:t})=>{const{scene:d}=a(),g=r(S,[t]),p=e.exports.useMemo((()=>new l(new s(1,32,32),new o({shininess:100}),g.length)),[g]);return e.exports.useEffect((()=>{g.forEach(((e,t)=>{const a=new c,r=new u,l=new m,s=Math.min(25,e.count),o=new n(s,s,s);l.setFromEuler(r),a.compose(e.vector,l,o),p.setMatrixAt(t,a);const d=e.vector.normalize(),g=new i(d.x,d.y,d.z);p.setColorAt(t,g)})),null==d||d.add(p)}),[g]),null};const R=()=>d.createElement("input",{className:"file-input",name:"file",type:"file",id:"imageFile2",capture:"environment",accept:"image/*"}),k=({setImage:t})=>{const n=e.exports.useRef();return e.exports.useEffect((()=>{g.registerDialog(n.current)}),[]),d.createElement("dialog",{ref:n,open:!0},d.createElement("form",{onSubmit:e=>{e.preventDefault();const n=new FormData(e.currentTarget),a=n.get("image-src"),r=n.get("file");t(a||r),e.currentTarget.reset()}},d.createElement("label",null,d.createElement("div",null,"Paste an image URL to start"),d.createElement("input",{name:"image-src",type:"url",inputMode:"url",autoFocus:!0})),d.createElement("a",{className:"link",href:"https://unsplash.com",target:"_blank",rel:"noreferrer"},"Try Unsplash",d.createElement("br",null),"The internetâ€™s source of freely-usable images."),d.createElement(R,null),d.createElement("button",{type:"submit"},"Submit")))};var C=!!window.location.search.split("ar=")[1];const D=t=>{const{src:n}=t,[a,r]=e.exports.useState();return e.exports.useEffect((()=>{if(n instanceof File){const e=new FileReader;e.onloadend=t=>{r(e.result)},e.readAsDataURL(n)}else r(n)}),[]),a?d.createElement("img",{className:"thumbnail",src:a,alt:"thumbnail"}):null},I=C?b:w;function N(){const[t,n]=e.exports.useState(null),a=e.exports.useRef();return d.createElement(d.Fragment,null,d.createElement(I,{style:{height:"75vh",width:"100vw",border:"1px solid black"},key:t},d.createElement(p,{makeDefault:!0,autoRotate:!0,position:[-10,-10,-5],rotation:[3,-1,2.5533897942197092],zoom:3},d.createElement("ambientLight",null),d.createElement("pointLight",{position:[10,10,10]}),t&&d.createElement(e.exports.Suspense,{fallback:d.createElement(x,null)},d.createElement(F,{imageSrc:t})),d.createElement(E,{ref:a}),y&&d.createElement(f,{alignment:"bottom-right",margin:[80,80],onTarget:()=>{var e;return null==(e=null==a?void 0:a.current)?void 0:e.target},onUpdate:()=>{var e;return null==(e=a.current)?void 0:e.update()}},d.createElement(h,{axisColors:["red","green","blue"],labelColor:"white"})))),t?d.createElement("div",{className:"flex-center"},d.createElement("button",{onClick:()=>n(null)},"New image"),d.createElement(D,{src:t})):d.createElement(k,{setImage:n}))}v.render(d.createElement(d.StrictMode,null,d.createElement(N,null)),document.getElementById("root"));
